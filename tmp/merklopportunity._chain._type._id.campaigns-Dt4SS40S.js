const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/liquidity-widget-DdGhyslr.js","assets/chunk-4WY6JWTD-C-sa5HNl.js","assets/jsx-runtime-u17CrQMm.js","assets/index-y_TnctKp.js","assets/shallow-CTkKvg1N.js","assets/config.context-BnxvCso8.js","assets/liquidity-widget-Dc59a7As.css"])))=>i.map(i=>d[i]);
import{r as o,R as I,c as ce,w as me,j as pe,u as de,b as ue,O as xe}from"./chunk-4WY6JWTD-C-sa5HNl.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{E as fe}from"./ErrorContent-iFy0Uouv.js";import{u as Q,b as he}from"./Wallet.context-BvbpRuml.js";import{C as ge}from"./chainId-DlC7om46.js";import{B as F}from"./button-M0b_jedp.js";import{A as je,T as we}from"./TvlTooltip-0p97ZeCo.js";import{A as ye}from"./AprValue-DparvFNG.js";import{T as d}from"./Tag-C_ORbKnJ.js";import{g as be}from"./useOpportunityFilters-DyAn3bHZ.js";import{u as _}from"./config.context-BnxvCso8.js";import{u as J}from"./useUserPreferences-Qp5XhzZ6.js";import{u as ke}from"./useMixpanelTracking-DOfYEr7m.js";import{T as Ne}from"./token-Cl3Swn4g.js";import{u as ve}from"./useOpportunityMetadata-DjKw5Epd.js";import{u as Ce}from"./token.service-DT4hm07-.js";import{_ as q}from"./preload-helper-BXl3LOEh.js";import{W as Te}from"./WalletConnectBlock-isMGV6_M.js";import{M as X}from"./Modal-CItmMrsY.js";import{G as r,T as a}from"./Text-s-7T7AgB.js";import{B as Y}from"./Box-TjXUd_sS.js";import{N as ze}from"./Notifications-D3Zt1Atq.js";import{O as Re}from"./OpportunityParticipateModal-DGPpjBL4.js";import{p as Se,D as P}from"./parseUnits-BXOpw5QU.js";import{f as Me}from"./transactionReceipt-DWSw1YDL.js";import{V as T}from"./Value-DP-ddCj7.js";import{I as z}from"./Icon-yIzcnvx6.js";import{T as L}from"./Title-NHXnWzqt.js";import{T as Pe}from"./Tooltip-DAdp1oea.js";import{T as _e}from"./ToggleBox-DPvXcBmf.js";import{C as Ee}from"./Container-CXYR4jot.js";import"./Space-BpNv155y.js";import"./index-ClqSVVk3.js";import"./css-DJ4j81Gp.js";import"./index-B1cRlTjw.js";import"./sha256-Cbe3se47.js";import"./waitForCallsStatus-Dr9KYq26.js";import"./getAbiItem-qpEi-AK6.js";import"./typedData-ilRis_tS.js";import"./prepareAuthorization-XunYVCgE.js";import"./index-CDryzkHt.js";import"./utils-Cqk7bgkn.js";import"./avatar-BKGp_vp_.js";import"./Hash-BwZTJhoo.js";import"./Copy-Bj8i1qzv.js";import"./useClipboard-B8Dit59t.js";import"./EventBlocker-DvWuEVI-.js";import"./Button-BeHg2_Al.js";import"./Divider-Deq_HRpf.js";import"./module-3rE_GSaZ.js";import"./metadata.service-CYEZM6Ok.js";import"./v4-BKrj-4V8.js";import"./useIsMobile-Dz3gkJW4.js";import"./formatter.service-DwCXTGXN.js";import"./utils-BCzdQfNw.js";import"./wallet-connectors-BAKEwGGt.js";import"./WalletEcosystemModal-CBgEawfU.js";import"./use-mobile-BvvNuNIx.js";import"./index-DLdlQWz7.js";import"./index-BhXl3Ys3.js";import"./index-y_TnctKp.js";import"./Combination-NFXuYW8G.js";import"./x-Bssr4wR2.js";import"./createLucideIcon-CMb-tl5F.js";import"./useBalances-DzZLYGzH.js";import"./Token-Df4UsgAN.js";import"./Input-C4q7c6L5.js";import"./format-CyYjQlLp.js";import"./index-BJBgMJBI.js";import"./index-DsQUPERn.js";import"./Collapsible-O6afIPec.js";import"./index-B4gA1gxr.js";import"./List-D-Q1z2_a.js";import"./index-whAqmSU3.js";import"./index-Dhg-psZY.js";import"./index-BCx67JHr.js";const Ae=o.lazy(async()=>{const j=await q(()=>import("./liquidity-widget-DdGhyslr.js"),__vite__mapDeps([0,1,2,3,4,5]));return await q(()=>Promise.resolve({}),__vite__mapDeps([6])),{default:j.LiquidityWidget}});function Oe(j){const{opportunity:t,onClose:w}=j,i=Q(),{address:b,chainId:k,switchChain:x}=i;if(t.type!=="UNISWAP_V4"||![1,42161,130].includes(t.chain.id))return null;const u=o.useMemo(()=>t.identifier,[t.identifier]),[y,v]=o.useState(!1),f=o.useCallback(()=>{v(!0)},[]),h=o.useCallback(()=>{x&&t.chain.id!==k&&x(t.chain.id)},[x,t.chain.id,k]),R=o.useCallback(async n=>{if(!b||i.chainType!==he.EVM||!i.sendTransaction||!i.evm?.client)throw new Error("Wallet not connected");const c=new ze({title:"KyberSwap Zap",subtitle:"Sign transaction in your wallet",icon:{remix:"RiLoader2Fill"},loading:!0});try{const N=await i.sendTransaction([{chain:i.evm?.client.chain,account:b,to:n.to,data:n.data,value:BigInt(n.value),gas:BigInt(n.gasLimit)}]);return c.update({subtitle:"Transaction submitted successfully",icon:{remix:"RiCheckFill"},loading:!1}),N}catch(N){throw c.update({subtitle:"Transaction failed",icon:{remix:"RiCloseFill"},loading:!1}),console.error("Transaction failed:",N),N}},[b,i.sendTransaction]),S=o.useCallback(()=>{w?.()},[w]),M=_(n=>n.config.kyberSwapTheme),{userPreferences:C}=J(),E=o.useMemo(()=>{const n=C.theme==="light"?"light":"dark";return M?.[n]},[M,C.theme]);return e.jsxs("div",{onClick:n=>n.stopPropagation(),onMouseDown:n=>n.stopPropagation(),className:"w-full",style:{position:"relative",zIndex:9999},children:[e.jsx("style",{children:`
        [data-radix-popper-content-wrapper],
        [role="dialog"],
        [role="menu"],
        [role="listbox"],
        .kyberswap-widget-modal,
        .kyberswap-widget-overlay {
          z-index: 99999 !important;
        }
      `}),e.jsx(X,{title:"Connect wallet",className:"mx-auto w-full max-w-[500px]",state:[y,v],modal:e.jsxs(r,{children:[e.jsx(a,{children:"Select your wallet from the list below"}),e.jsx(Te,{})]})}),e.jsx(o.Suspense,{fallback:e.jsx(Y,{className:"w-full p-xl flex items-center justify-center bg-[#10131C] text-[#EBEEF7] rounded-lg",children:e.jsx(a,{children:"Loading KyberSwap Zap..."})}),children:e.jsx(Ae,{theme:E,poolType:68,poolAddress:u,chainId:t.chain.id,connectedAccount:{address:b,chainId:k??t.chain.id},onClose:S,onConnectWallet:f,onSwitchChain:h,onSubmitTx:R,source:"merkl"})})]})}function Be(j){const{opportunity:t,className:w,targets:i}=j,[b,k]=I.useState(!1),x=ce(),u=_(s=>s.config.deposit),y=_(s=>s.config.decimalFormat.dollar),v=_(s=>s.config.decimalFormat.point),{url:f}=ve(t),{isOnlyPoint:h,pointAggregation:R,campaignMultiplier:S,formattedPer1kText:M,hasCampaignApr:C,per1kValue:E}=Ce(t),n=o.useMemo(()=>h?S:null,[h,S]),c=o.useMemo(()=>t.type==="TRANSFER"||t.type==="JSON_AIRDROP"||t.type==="AIRDROP",[t.type]),N=o.useMemo(()=>u&&i?!0:!(!u&&!f&&!c),[f,i,u,c]),{userPreferences:ee}=J(),te=ee.theme,{track:g}=ke(),{address:W}=Q(),se=o.useCallback(()=>{if(c)return x(`/users/${W??""}`);if(f&&g("Click on supply",{...t,mode:u&&i?"direct":"indirect"}),(!u||!i)&&f)return window.open(f,"_blank","noopener,noreferrer");k(!0)},[f,i,u,g,t,W,c,x]),D=o.useMemo(()=>be(t.action)?.cta??"Supply Liquidity",[t]),m=o.useMemo(()=>t?.rewardsRecord?.breakdowns.reduce((s,{token:p})=>(s.some(l=>l.id===p.id)||s.push(p),s),[]),[t?.rewardsRecord?.breakdowns]),V=o.useMemo(()=>t.apr&&t.apr>0?t.apr:"-",[t.apr]),U=o.useCallback(s=>{if(!m||m.length===0)return;const p=t?.tokens?.find(B=>B.id===s);if(!p)return console.error("Token not found");const l=new URLSearchParams;l.append("fromChain",t.chain.id.toString()),l.append("toChain",t.chain.id.toString()),l.append("toToken",p.address),g("Click on button",{button:"Bridge_token",type:"bridge",full_label:"Bridge token"}),x(`/bridge?${l.toString()}`)},[t?.tokens,t?.chain?.id,m,g,x]),[re,$]=I.useState(!1),[oe,A]=I.useState(!1),O=o.useMemo(()=>t?.tokens?.filter(s=>!!s?.icon),[t]),ie=t.type==="CLAMM"&&t.tokens.some(s=>s.price===void 0),G=o.useMemo(()=>t.type==="UNISWAP_V4"&&t.chainId===ge.ETHEREUM,[t.type,t.chainId]),K=o.useMemo(()=>{const p=t.campaigns[0]?.rewardToken;let l=0n;for(const le of t.campaigns)l+=Se(le.amount,0);const B=l?Me(l,p.decimals):"0",ae=l?(p.price??0)*Number.parseFloat(B??"0"):0;return e.jsx(T,{value:!0,format:y,children:ae})},[t?.campaigns,y]),Z=o.useMemo(()=>{const p=`${t?.rewardsRecord?.breakdowns.some(l=>l.token.type==="PRETGE")?"~":""}${y}`;return e.jsx(T,{value:!0,format:p,children:t.dailyRewards})},[t?.rewardsRecord?.breakdowns,t.dailyRewards,y]),H=o.useMemo(()=>e.jsx("span",{className:"inline-flex items-center gap-xs",children:e.jsx(T,{value:!0,format:v,children:R})}),[R,v]),ne=o.useMemo(()=>{if(m){if(h)return H;if(c)return K}return Z},[c,h,H,Z,m,K]);return e.jsxs(e.Fragment,{children:[e.jsx(Re,{opportunity:t,targets:i,state:[b,k]}),oe&&e.jsx("div",{className:"fixed inset-0 z-100 flex items-center justify-center bg-black/75",onClick:()=>A(!1),children:e.jsx("div",{className:"relative w-[95vw] max-w-[1200px] max-h-[90vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:e.jsx(Oe,{opportunity:t,onClose:()=>A(!1)})})}),e.jsxs(Y,{className:`w-full !gap-0 h-[fit-content] overflow-hidden ${w} ${te} !p-0 bg-main-2!`,children:[e.jsxs(r,{className:"items-center flex-nowrap bg-main-4 py-xlx2 p-xl w-full justify-between",size:"sm",children:[e.jsxs(a,{size:"md",bold:!0,className:"uppercase flex items-center gap-sm w-full !text-accent-12",children:[e.jsx(z,{remix:"RiStarFill"}),c?"Total Rewards":"Daily Rewards"]}),e.jsx(r,{className:"items-center justify-between",children:e.jsx(L,{look:"hype",h:3,className:"!text-accent-12 ",children:ne})})]}),e.jsxs(r,{className:"p-xl py-lg  h-[fit-content] w-full justify-between flex-col gap-xl ",children:[!c&&e.jsxs(r,{size:"lg",className:"flex-nowrap",children:[e.jsxs(r,{className:"border-1 rounded-lg bg-main-3 p-lg flex-col flex-1",size:"sm",children:[h?e.jsxs(a,{bold:!0,className:"flex items-center gap-sm",children:["Multiplier"," ",e.jsx(Pe,{helper:`For a $1,000 deposit, you’ll earn ${C?n:E} points daily`})]}):typeof V=="number"?e.jsx(P,{onHover:!0,size:"xl",containerClassName:"!rounded-xs",onOpen:()=>g("Click on opportunity button",{button:"apr",type:"tooltip",opportunity:t}),content:e.jsx(je,{opportunity:t}),children:e.jsxs(a,{bold:!0,className:"flex items-center gap-sm",children:["APR",e.jsx(z,{remix:"RiQuestionFill",size:"sm",className:"fill-accent-10"})]})}):e.jsx(a,{bold:!0,className:"flex items-center gap-sm",children:"APR"}),e.jsx(L,{h:3,look:"tint",children:h?e.jsx(r,{className:"min-w-0 flex-nowrap items-center overflow-hidden",children:C?e.jsx(T,{value:!0,format:"0,0.##a",children:n??0}):M}):e.jsx(ye,{value:!0,children:V})})]}),e.jsxs(r,{className:"border-1 rounded-lg bg-main-3 p-lg flex-col flex-1",size:"sm",children:[t?.tvlRecord?.breakdowns&&t?.tvlRecord?.breakdowns?.length>=2?e.jsx(P,{onHover:!0,size:"xl",containerClassName:"!rounded-xs",onOpen:()=>g("Click on opportunity button",{button:"tvl",type:"tooltip",opportunity:t}),content:e.jsx(we,{opportunity:t}),children:e.jsxs(a,{bold:!0,className:"flex items-center gap-sm",look:"soft",children:["TVL",e.jsx(z,{remix:"RiQuestionFill",size:"sm",className:"fill-accent-10"})]})}):e.jsxs(a,{bold:!0,className:"flex items-center gap-sm ",children:["TVL",e.jsx(z,{remix:"RiQuestionFill",size:"sm",className:"fill-accent-10"})]}),e.jsxs(L,{h:3,look:"tint",className:"whitespace-nowrap ",children:[ie?"> ":void 0,e.jsx(T,{value:!0,format:y,children:t.tvl})]})]})]}),e.jsx(r,{className:"w-full justify-center gap-lg",children:e.jsxs(r,{className:"border-1 rounded-lg bg-main-3 p-lg flex-col flex-1",size:"md",children:[t.tokens&&t.tokens.length>0&&e.jsxs(r,{className:"justify-between items-center flex-nowrap w-full",children:[e.jsx(a,{size:"sm",children:"What you need"}),e.jsxs(r,{className:"gap-sm justify-end flex-nowrap items-center",children:[t.tokens.slice(0,1).map(s=>e.jsx(d,{type:"token",value:s,look:"soft",size:"xs"},s.id)),t.type!=="AAVE_NET_LENDING"&&t.tokens.length>1&&e.jsx(P,{className:"flex",onHover:!0,size:"md",content:e.jsx(r,{className:"flex-col gap-lg p-sm",children:t.tokens.slice(1).map(s=>e.jsx(d,{type:"token",value:s,look:"soft",size:"xs"},s.id))}),children:e.jsx(d,{type:"overflow",className:"flex",value:t.tokens.length-1,size:"xs"})}),e.jsx(d,{type:"chain",value:t.chain,size:"xs"})]})]}),t?.protocol&&e.jsxs(r,{className:"justify-between items-center flex-nowrap w-full",children:[e.jsx(a,{size:"sm",children:"Protocol"}),e.jsx(d,{look:"bold",type:"protocol",value:t.protocol,size:"xs"})]}),m&&m.length>0&&e.jsxs(r,{className:"justify-between items-center flex-nowrap w-full",children:[e.jsx(a,{size:"sm",children:"What you earn"}),e.jsxs(r,{className:"gap-sm justify-end flex-nowrap items-center",children:[m.slice(0,1).map(s=>e.jsx(d,{type:"token",value:s,look:"soft",size:"xs"},s.id)),m.length>1&&e.jsx(P,{className:"flex",onHover:!0,size:"md",content:e.jsx(r,{className:"flex-col gap-sm p-sm",children:m.slice(1).map(s=>e.jsx(d,{type:"token",value:s,look:"soft",size:"xs"},s.id))}),children:e.jsx(d,{type:"overflow",value:m.length-1,size:"xs"})}),t.campaigns[0]?.distributionChain&&e.jsx(d,{type:"chain",value:t.campaigns[0].distributionChain,size:"xs"})]})]}),t.explorerAddress&&e.jsxs(r,{className:"justify-between items-center flex-nowrap w-full",children:[e.jsx(a,{size:"sm",children:"Contract"}),e.jsx(d,{type:"explorer",value:{address:t.explorerAddress,chainId:t.chain.id},size:"xs"})]})]})}),e.jsxs(r,{className:" gap-lg",children:[G&&e.jsx(F,{className:"inline-flex justify-center font-normla !w-full",variant:"primary",size:"xl",onClick:()=>{g("Click on button",{button:"KyberSwap_Zap",type:"zap",full_label:"Zap with KyberSwap",opportunity:t}),A(!0)},children:e.jsxs("span",{className:"items-center gap-sm",children:[D," ",e.jsx(a,{className:"text-white! font-normal",children:"via KyberZap"})]})}),!!N&&e.jsxs(F,{className:"inline-flex justify-center !w-full",variant:G?"secondary":"primary",size:"xl",onClick:se,children:[D,(!i||!u)&&e.jsx(z,{remix:"RiArrowRightUpLine",size:"sm"})]})]}),!c&&e.jsxs(r,{className:"w-full justify-center gap-sm",children:[e.jsx(a,{children:"Missing assets?"}),e.jsx(X,{title:"Get the missing token",state:[re,$],modal:e.jsxs(r,{children:[e.jsx(a,{children:"Select the asset you’re missing and get it through Jumper Bridge"}),e.jsx(r,{className:"w-full grid grid-cols-2",children:O?.map(s=>e.jsx(_e,{onClick:()=>U(s?.id),prefix:e.jsx(Ne,{icon:s?.icon,seed:s.address,size:24,type:s?.type,alt:s.symbol||"token"}),title:s.symbol,description:"Get this asset",className:"w-full"}))})]})}),e.jsx(F,{variant:"ghost",className:"p-0!",onClick:()=>{g("Click on button",{button:"Bridge_get",type:"bridge",full_label:"Get them now"}),O?.length===1?U(O?.[0].id):$(!0)},children:"Get them now"})]})]})]})]})}const is=me(function(){const{targets:t}=de(),{opportunity:w,chain:i}=ue();return e.jsx(Ee,{children:e.jsxs(r,{className:"flex flex-col xl:flex-row-reverse xl:flex-nowrap gap-xl py-xl",children:[e.jsx(Be,{opportunity:w,targets:t,className:"w-full xl:min-w-[24ch] xl:max-w-[40ch]"}),e.jsx(r,{className:"flex grow flex-col items-start gap-xl xl:flex-1",children:e.jsx(xe,{context:{opportunity:w,chain:i}})})]})})}),ns=pe(function(){return e.jsx(fe,{})});export{ns as ErrorBoundary,is as default};
